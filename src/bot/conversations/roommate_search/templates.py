from conversations.profile.constants import MAX_AGE, MIN_AGE
from conversations.roommate_search.buttons import ANY_AGE_BTN, ANY_GENDER_BTN
from internal_requests.entities import ProfileSearchSettings

ASK_SEARCH_SETTINGS = (
    "–ë—É–¥–µ–º –∏—Å–∫–∞—Ç—å —Å–æ—Å–µ–¥–∞ –ø–æ —Ç–∞–∫–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º\n" "–∏–ª–∏ —Ö–æ—á–µ—à—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–∏—Å–∫ –∑–∞–Ω–æ–≤–æ?"
)
SEARCH_INTRO = (
    "–í—Å–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–∏—Å–∫–∞ —Å–æ—Å–µ–¥–∞ —Å —É—á–µ—Ç–æ–º –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫."
    " –ò—Å–ø–æ–ª—å–∑—É–π /cancel –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∏—Å–∫."
    "\n–£–¥–∞—á–∏!"
)

ASK_LOCATION = "–î–∞–≤–∞–π –Ω–∞–π–¥–µ–º —Ç–µ–±–µ —Å–æ—Å–µ–¥–∞. –í –∫–∞–∫–æ–º –≥–æ—Ä–æ–¥–µ —Ç—ã –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –∂–∏—Ç—å?"
ASK_SEX = "–° –∫–µ–º –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –¥–µ–ª–∏—Ç—å –∂–∏–ª—å—ë?"
ASK_AGE_MIN = "–ö–∞–∫–æ–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç —Ç—ã –±—ã –ø—Ä–µ–¥–ø–æ—á—ë–ª —É —Å–≤–æ–µ–≥–æ —Å–æ—Å–µ–¥–∞?"
ASK_AGE_MAX = (
    "–û—Ç–ª–∏—á–Ω–æ! –ê –∫–∞–∫–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç —Ç—ã –±—ã —Ö–æ—Ç–µ–ª –≤–∏–¥–µ—Ç—å —É —Å–≤–æ–µ–≥–æ —Å–æ—Å–µ–¥–∞?"
)
AGE_ERR_MSG = f"–ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –≤–æ–∑—Ä–∞—Å—Ç –æ—Ç {MIN_AGE} –¥–æ {MAX_AGE} –ª–µ—Ç."
PROFILE_LIKE_TEXT = (
    "–û—Ç–ª–∏—á–Ω–æ —Ç—ã –ø–æ—Å—Ç–∞–≤–∏–ª <b>¬´–ª–∞–π–∫ üëç¬ª</b>,"
    " –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º,"
    " –æ–∂–∏–¥–∞–π –º—ç—Ç—á–∞ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π –ø–æ–∏—Å–∫!"
)
NO_MATCHES = (
    "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –±–æ–ª—å—à–µ –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ç–µ–±–µ —Å–æ—Å–µ–¥–µ–π.\n"
    "–¢—ã –º–æ–∂–µ—à—å –ø–æ–¥–æ–∂–¥–∞—Ç—å –ø–æ–∫–∞ –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞."
)
END_OF_SEARCH = (
    "–ù–∞–¥–µ—é—Å—å, —Ç—ã —Å–º–æ–≥ –Ω–∞–π—Ç–∏ —Å–µ–±–µ —Å–æ—Å–µ–¥–∞.\n"
    "–ê –µ—Å–ª–∏ –Ω–µ—Ç, –ø–æ–º–Ω–∏, —á—Ç–æ —Ç—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—à—å –Ω–∞—á–∞—Ç—å –ø–æ–∏—Å–∫ –∑–∞–Ω–æ–≤–æ."
)
LIKE_NOTIFICATION = "–ö—Ç–æ-—Ç–æ —Ö–æ—á–µ—Ç —Å—Ç–∞—Ç—å —Ç–≤–æ–∏–º —Å–æ—Å–µ–¥–æ–º, –ø–æ—Å–º–æ—Ç—Ä–∏–º –∫—Ç–æ —ç—Ç–æ?"
SEND_LIKE = "<b>–í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ª–∞–π–∫–Ω—É–ª–∏ {receiver_name}</b>"
BUTTON_ERROR_MSG = "–í—ã–±–µ—Ä–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç."


def format_search_settings_message(filters: ProfileSearchSettings) -> str:
    """–§–æ—Ä–º–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ–∏—Å–∫–∞."""
    result = f"""
    <b>–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–∞ —Å–æ—Å–µ–¥–∞:</b>

    <b>–ì–æ—Ä–æ–¥:</b> {filters.location}
    <b>–ü–æ–ª —Å–æ—Å–µ–¥–∞:</b> {ANY_GENDER_BTN if filters.sex is None else filters.sex}
    <b>–í–æ–∑—Ä–∞—Å—Ç:</b> {_get_age_range_string_from_search_settings(filters)}"""
    return result


def _get_age_range_string_from_search_settings(filters: ProfileSearchSettings) -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∂–µ–ª–∞–µ–º–æ–≥–æ —Å–æ—Å–µ–¥–∞."""
    age_min, age_max = filters.age_min, filters.age_max
    if age_min or age_max:
        return f"–æ—Ç {age_min} " * bool(age_min) + f"–¥–æ {age_max}" * bool(age_max)
    return ANY_AGE_BTN


MAXIMUM_AGE_ERROR_MESSAGE = "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ."
